
<html lang="en">
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" type="text/javascript"></script>
<script type="module">
    class EventItem {
        constructor(date, start, end, hasEnd, img, name, selection, desc, eintritt) {
            this.date = date;
            this.name = name;
            this.desc = desc;
            this.eintritt = eintritt;
            this.selection = selection;
            this.hasEnd = hasEnd;
            this.img = img;
            this.start = start;
            this.end = end;
        }
    }
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics.js";
    import {
    collection,
    getDocs,
    getFirestore,
    getDoc,
    doc,
    query,
    orderBy,
    limit,
    setDoc,
    Timestamp,
    deleteDoc,
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    const firebaseConfig = {
    apiKey: "AIzaSyDMnQr16h-2-ofKciZiJCslIVSWncxp2xM",
    authDomain: "schleglapp-dce81.firebaseapp.com",
    projectId: "schleglapp-dce81",
    storageBucket: "schleglapp-dce81.appspot.com",
    messagingSenderId: "596674561612",
    appId: "1:596674561612:web:035f933ec53eb7e6d756e9",
    measurementId: "G-3GFM2S4GH8",
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);

    var events = [];
    readyUp();

    function json1(name, imageURL, date, selection){
        this.name = name;
        this.imageURL = imageURL;
        this.date = date;
        this.selection = selection;
    }

    async function readyUp() {
        await getEvents(new Date());
    
        var id_list = Array();
        events.forEach((event) => {
            id_list.push(new json1(event.name, event.img, event.date, event.selection));
        });
            
        id_list = JSON.stringify(id_list);
        document.write(id_list);
        
    }

    async function getEvents(date) {
        events = [];
        const q1 = query(collection(db, "books", "2023-03", "events"));
        const querySnapshot = await getDocs(q1);
        querySnapshot.forEach((doc) => {
            let end = doc.data().end.toDate();
            let start = doc.data().start.toDate();
            let hasEnd = doc.data().hasEnd;
            let img = doc.data().img;
            let name = doc.data().name;
            let selection = doc.data().selection;
            let date = doc.data().date.toDate();
            let desc = doc.data().desc;
            let eintritt = doc.data().eintritt;

            let item = new EventItem(
            date,
            start,
            end,
            hasEnd,
            img,
            name,
            selection,
            desc,
            eintritt
            );
            events.push(item);
        });
    }


    
 </script>
 </head>
 </html>